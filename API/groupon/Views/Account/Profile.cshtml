
@{
    ViewData["Title"] = "Profile";
}

<div class="container-fluid main-register-login mt-5 mb-5">
    <h1>User Settings</h1>
    <hr>
    <h2 class="mb-5">Update your profile by changing and adding information</h2>
    <div class="container sub-register-login profile">
        <form id="form">
            <div class="profile">
                <div class="profile-avatar-wrap">
                    <img src="~/images/avatar-upload.png" id="profile-avatar" alt="Image for Profile">
                </div>
                <label for="uploader">
                    <img id="profile-picture" class="mt-3" width="42px" src="~/images/upload.png" />
                </label>
                <input class="input-file" type="file" id="uploader">
            </div>
            <h2 class="mt-5 text-left">Personal Information</h2>
            <hr>
            <div class="row mt-4 text-left">
                <div class="col-md-12">
                    <label>First Name & Last Name</label>
                    <input id="Name" class="form-control" type="text" placeholder="John Smith" />
                </div>
            </div>
            <div class="row mt-3 text-left">
                <div class="col">
                    <label>Personal Email Address</label>
                    <input id="Email" type="text" class="form-control" placeholder="johnsmith@mail.com" />
                </div>
            </div>
            <div class="row mt-3 text-left">
                <div class="col-md-6">
                    <label>Country / Region</label>
                    <input id="Country" type="text" class="form-control" placeholder="USA" />
                </div>
                <div class="col-md-6">
                    <label>State / City</label>
                    <input id="City" type="text" class="form-control" placeholder="Vilnius" />
                </div>
            </div>
            <h2 class="mt-5 text-left">Education</h2>
            <hr>
            <div class="row mt-3 text-left">
                <div class="col-md-6">
                    <label>School</label>
                    <input id="School" type="text" class="form-control" placeholder="The University of Alabama" />
                </div>
                <div class="col-md-6">
                    <label>Study Field</label>
                    <input id="StudyField" type="text" class="form-control" placeholder="Software Systems" />
                </div>
            </div>
            <div class="row mt-3 text-left">
                <div class="col-md-6">
                    <label>Degree</label>
                    <input id="School" type="text" class="form-control" placeholder="Bachelors Degree" />
                </div>
            </div>
            <h2 class="mt-5 text-left">Specialization & Work Experience</h2>
            <hr />
            <div class="row mt-4 text-left">
                <div class="col-md-6">
                    <label>Specialization</label>
                    <input id="Title" type="text" class="form-control" placeholder="Software Developer" />
                </div>
                <div class="col-md-6">
                    <label>Work Experience</label>
                    <input id="WorkExperience" type="text" class="form-control" placeholder="2 years" />
                </div>
            </div>
            <div class="row mt-4 text-left">
                <div class="col-md-6">
                    <label>Currently Working</label>
                    <input id="CurrentlyWorkingAt" type="text" class="form-control" placeholder='UAB "GroupUp"'/>
                </div>
                <div class="col-md-6">
                    <label>Position</label>
                    <input id="CurrentlyWorkingAs" type="text" class="form-control" placeholder='Jr. Software Engineer'/>
                </div>
            </div>
            <h2 class="mt-5 text-left">Your Skills & Talents</h2>
            <hr />
            <div class="row mt-4">
                <div class="col-lg-8">
                    <div class="input-group">
                        <div class="input-group mb-3">
                            <input type="text" class="form-control form-control-skills" placeholder="Add skill..." aria-label="Recipient's username" aria-describedby="basic-addon2"/>
                            <div class="input-group-append">
                                <button class="btn btn-light blue form-control-feedback add-btn" type="button">Button</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row ">
                <div class="col-md-12">
                    <div class="list-group">
                        <div href="#" class="list-group-item">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="expertise">
                                        <p class="todo-list-1 text-left">
                                            @*<span class="label label-default expertise ">.NET <i class="fa fa-times"></i></span>
                                            <span class="label label-default expertise ">SQL <i class="fa fa-times"></i></span>
                                            <span class="label label-default expertise ">Angular 2 <i class="fa fa-times"></i></span>*@
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <button type="button" id="SubmitButton" class="btn-special button-centered blue">Update Your Profile</button>
        </form>
    </div>
</div>


<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"
        asp-fallback-src="~/lib/jquery/dist/jquery.min.js"
        asp-fallback-test="window.jQuery"
        crossorigin="anonymous"
        integrity="sha384-K+ctZQ+LL8q6tP7I94W+qzQsfRV2a+AfHIi9k8z8l9ggpc8X+Ytst4yBo/hH+8Fk">
</script>


<script>

    $("#SubmitButton").click(updateProfile);

    $(document).ready(function () {
        $.get("https://localhost:44330/Account/getuserid", function (userId) {
        $.ajax({
            url: "https://localhost:44330/api/profile/overview",
            type: "Get",
            data: {
                id: userId
            },
            statusCode: {
                200: function (data) {
                    $("#Name").val(data.name);
                    console.log("Successful. ");
                },
                400: function () {
                    console.log("Client side error. ");
                },
                500: function () {
                    console.log("Server side error. ");
                }
            }
            });
        });
        false;
    });


    function updateProfile() {
        //Not the best solution, later will update
        var labels = document.querySelectorAll('.label-default')
        var fields = "";
        for (var x = 0; x < labels.length; x++) {
            fields += labels[x].innerText + ";";

        }
        $.ajax({
            url: "https://localhost:44330/api/profile/update",
            type: "POST",
            data: {
                Name: $("#Name").val(), Company: 0, field: fields, workExperience: $("#WorkExperience").val(), education: $("#School").val() + ", " + $("#Degree").val() + " in " + $("#StudyField").val(), location: $("#City").val() + ", " + $("#Country").val(), picture: $("#profile-avatar").attr('src'), currentlyWorking: $("#CurrentlyWorkingAt").val() + ", " + $("#CurrentlyWorkingAs").val()
            },
            statusCode: {
                200: function () {
                    console.log("Successful. ");
                },
                400: function () {
                    console.log("Client side error. ");
                },
                500: function () {
                    console.log("Server side error. ");
                }
            }
        });
        false;
    }

//function UpdateProfile() {
//    $.ajax({
//        url: "https://localhost:44330/api/profile/update",
//        type: "POST",
//        data: {
//            Name: $("#Name").val(), Company: 0, field: $("#StudyField").val(), workExperience: $("WorkExperience").val(), education: $("#School").val() + ", " + $("#Degree").val() + " in " + $("#StudyField").val(),
//            location: $("#City").val() + ", " + $("#Country").val(), picture: $("#profile-avatar").val(), currentlyWorking: $("#CurrentlyWorkingAt").val() + ", " + $("#CurrentlyWorkingAs").val()
//        },
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        success: function (result) {
//            console.log(result);
//            console.log($("#StudyField").val());
//        },
//        error: function (response) {
//            console.log($("#StudyField").val());
//            alert('error when loading groups');
//        }
//    });
//}

//function GetAllFields() {
//    $.ajax({
//        type: "GET",
//        url: "https://localhost:44330/account/getuserfields",
//        data: {},
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        success: function (result) {
//            console.log(result);
//        },
//        error: function (response) {
//            alert('error when loading groups');
//        }
//    });
//}

//function AddNewFields() {
//    $.ajax({
//        type: "POST",
//        url: "https://localhost:44330/account/updatefield",
//        data: { newField = 'textbox input' },
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        success: function (result) {
//            console.log(result);
//        },
//        error: function (response) {
//            alert('error when loading groups');
//        }
//    });
//}

//$(function () {
//    $('input[name="showthis"]').hide();

//    //show it when the checkbox is clicked
//    $('input[name="checkbox"]').on('click', function () {
//        if ($(this).prop('checked')) {
//            $('input[name="showthis"]').fadeIn();
//        } else {
//            $('input[name="showthis"]').hide();
//        }
//    });
//});
</script>
<script src="~/js/crop-image.js"></script>
<script src="~/js/upload-image.js"></script>
<script src="~/js/add-to-list.js"></script>
